<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"      
      >
    <h:head>
        <title>Facelet Title</title>
        
        <link href="/SIP_THEME/theme.css" rel="stylesheet" />
        
    </h:head>
    <h:body>
        <p:ajaxStatus onstart="PF('statusDialog').show()" oncomplete="PF('statusDialog').hide()"/>
            <p:dialog modal="true" widgetVar="statusDialog" header="Cargando..."
                      draggable="false" closable="false" resizable="false">
                <p:graphicImage value="/images/loadBar.gif"/>
            </p:dialog>
        <div>
            <p:dialog id="dialogRolesSave" widgetVar="dialogRolesSave" width="400" height="400"
                      closable="true" draggable="true" dynamic="true" header="Crear Grupos y Roles"
                      hideEffect="explode" modal="true" showEffect="explode">
                <table width="98%" cellspacing="30">
                            <tr>
                                <td width="20%" align="right">
                                    <p:outputLabel  for="tfNameRol" value="Nombre del Grupo:"/>
                                </td>
                                <td width="80%" align="left">
                                    <p:inputText    id="tfNameRol"  value="#{scrolesBean.scRolesAdd.name}"/>
                                </td>
                            </tr>
                            <tr>
                                <td width="20%" align="right">
                                    <p:outputLabel  for="tfDescriptionRol" value="Descripci贸n:"/>
                                </td>
                                <td width="80%" align="left">
                                    <p:inputTextarea    id="tfDescriptionRol"  
                                    value="#{scrolesBean.scRolesAdd.description}" />                                    
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:dataTable id="dataTablePermissions" value="#{scrolesBean.listAllPermissions}"
                                    paginator="true" rows="10"  var="permissions"
                                    pageLinks="40"
                                    paginatorTemplate="{CurrentPageReport}  {FirstPageLink} 
                                    {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                    rowKey="#{permissions.idModulePermission}"
                                    resizableColumns="true" 
                                    liveResize="true" rowsPerPageTemplate="10,20,30" 
                                    paginatorPosition="top" selection="#{scrolesBean.listPermissionsAdd}">
                                        
                                        <p:column selectionMode="multiple" width="16"/>
                                        <p:column headerText="Permiso" >
                                            <p:outputLabel value="Gestionar #{permissions.name}"/>
                                        </p:column> 
                                    </p:dataTable>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" align="center">
                                    <p:commandButton value="Guardar" actionListener="#{scrolesBean.saveRole()}"  
                                                     onsuccess="PF('dialogRolesSave').hide()"/>
                                    <p:spacer width="20"/>
                                
                                    <p:commandButton value="Cancelar" actionListener="#{scrolesBean.cleanFields()}" 
                                                     oncomplete="PF('dialogRolesSave').hide()"/>
                                </td>
                            </tr>
                        </table>
            </p:dialog>
            <h:form id="formRoles">
                <p:dataTable id="scrolesDataTable" draggableColumns="true" emptyMessage="" 
                         value="#{scrolesBean.rolesList}" var="roles"
                         paginator="true" rows="15"  
                         pageLinks="40"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} 
                         {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowKey="#{roles.idRole}"
                         resizableColumns="true" selection="#{scrolesBean.scRolesSelected}"
                         liveResize="true" rowsPerPageTemplate="15,30,50" 
                         selectionMode="single" paginatorPosition="top">
                <f:facet name="header">
                    <p:commandButton icon="ui-icon-plus" id="btnAdd" style="float: right;"  
                    oncomplete="PF('dialogRolesSave').show()">
                        <p:tooltip for="btnAdd" value="Agregar un Grupo"/>
                    </p:commandButton>
                </f:facet>
                <p:column headerText="Administraci贸n">
                    <center>
                        <p:commandButton icon="ui-icon-pencil" id="btnEdit">
                            <p:tooltip for="btnEdit" value="Editar Grupo"/>
                        </p:commandButton>
                        <p:spacer width="10"/>
                        <p:commandButton icon="ui-icon-close" id="btnDelete">
                            <p:tooltip for="btnDelete" value="Eliminar Grupo"/>
                        </p:commandButton>
                    </center>
                </p:column>
                <p:column headerText="ID" sortBy="#{roles.idRole}">    
                    <center>
                        #{roles.idRole}
                    </center>
                </p:column>
                <p:column id="columnRolName" headerText="Rol" sortBy="#{roles.name}">    
                    <p:tooltip for="columnRolName" value="#{roles.name}"/>
                    <center>
                        #{roles.name}
                    </center>
                </p:column>
                <p:column id="columnRolDescription" headerText="Descripci贸n" sortBy="#{roles.description}">    
                    <p:tooltip for="columnRolDescription" value="#{roles.description}"/>
                    <center>
                        #{roles.description}
                    </center>
                </p:column>
                <p:column id="columnRolCreationDate" headerText="Fecha de Creaci贸n" sortBy="#{roles.creationDate}">    
                    <p:tooltip for="columnRolDescription" value="#{roles.creationDate}"/>
                    <center>
                        #{roles.creationDate}
                    </center>
                </p:column>
                    
            </p:dataTable>
            </h:form>
        </div>
        
    </h:body>
</html>

